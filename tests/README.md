# Testing PySmali

PySmali does not yet have conventional unit tests.

Currently, testing is done by parsing and unparsing smali files and comparing the original to the reconstructed.

There are four levels of results when comparing the original and reconstructed smali files:
1. `[PASS]` They are exactly the same
2. `[WARNING]` They have different whitespace, but are semantically the same. This result is fine for unofficial or handwritten smali files, but is not acceptable for smali files generated by [baksmali](https://github.com/JesusFreke/smali).
3. `[FAIL]` They are semantically different
4. `[FATAL]` The original failed to be parsed

There are a total of 6,846 tests contained in the `tests.tar.xz` archive.

To run the tests execute `run_tests.py`. This python script will read directly from the `tests.tar.xz` archive.

The `tests.tar.xz` file can be updated in the following way:
1. Unpack the contents of `tests.tar.xz` to `src/`
2. Add additional, valid, smali files
3. Execute `generate_tests.py`

When making pull requests with additional tests, **DO NOT** include the `src/` folder.

## Requirements

* Python 3.8 or newer
* `tqdm~=4.59.0`

## OSS Attribution

### [tqdm/tqdm](https://github.com/tqdm/tqdm) by **Multiple contributors**  
_Licensed Under: [Various Licenses](https://github.com/tqdm/tqdm/blob/master/LICENCE)_

### Tests

Smali files used as tests in the `tests.tar.xz` archive have been obtained from the following projects:
- Android
- AndroidX
- Facebook
- FasterXML
- Google
- Java
- JavaX
- OkHttp
- Smali